!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("ExploratoryMap",[],e):"object"==typeof exports?exports.ExploratoryMap=e():t.ExploratoryMap=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){n(2);class i{constructor(t={}){this.options=Object.assign({selector:".exploratory-text-block",color:"#0dae0b"},t),this.block=document.querySelector(this.options.selector),this.block||console.warn('No element matched the selector "'+this.options.selector+'"'),this.svg=d3.select(this.block).append("svg"),this.side=this.block.querySelector(".et-side"),this.sideInner=this.side.querySelector(".et-side-inner"),this.nav=document.querySelector("nav.fixed"),this.highlights=[null],this.annots=[null],this.paths=[null],this.init()}drawConnection(t,e,n,i){if(!e||!n||!i)return;const o=e.querySelector(".et-first"),s=this.block.getBoundingClientRect(),l=o.getBoundingClientRect(),r=n.getBoundingClientRect(),c=(document.documentElement.scrollTop,r.right-s.left),a=r.y+r.height/2-s.top,d=l.left-s.left,h=l.y+l.height/2-s.top;return t.moveTo(c,a),t.lineTo(d,h),t}showConnection(t){let e=this.annots[t],n=this.highlights[t];this.paths[t];e&&n&&e.classList.contains("selected")&&n.classList.contains("selected")&&(e.classList.add("preview"),n.classList.add("preview"))}hideConnection(t){this.annots[t],this.highlights[t],this.paths[t]}scrollTo(t){const e=this.annots[t],n=document.querySelector("nav.fixed"),i=this.block.querySelector(".et-side-inner");if(!e)return;const o=e.getBoundingClientRect(),s=(i.getBoundingClientRect(),n.getBoundingClientRect());i.scrollBy({top:o.top-s.height,behavior:"smooth"})}selectAnnotation(t){let e=this.annots[t],n=this.highlights[t];this.paths[t];e&&e.classList.add("selected"),n&&n.classList.add("selected"),this.scrollTo(t),this.side.classList.remove("et-side-empty")}unselectAnnotation(t){const e=t.dataset.index;this.highlights[e];t.classList.remove("selected"),this.side.querySelectorAll(".selected").length||this.side.classList.add("et-side-empty")}positionAnnotations(t){const e=this.block.getBoundingClientRect(),n=this.nav.getBoundingClientRect(),i=this.side.getBoundingClientRect();this.sideInner.style.width=i.width+"px",this.side.style.height=this.sideInner.scrollHeight+i.top+"px",e.y<=n.height?(this.sideInner.style.height=window.innerHeight-n.height+"px",this.sideInner.style.position="fixed",this.sideInner.style.left=i.x+"px",this.sideInner.style.top=n.height+"px"):(this.sideInner.style.position="absolute",this.sideInner.style.left="",this.sideInner.style.top="")}resizeAnnotation(t){t.classList.toggle("et-less")}init(){const t=this,e=document.querySelector(".et-side-inner"),n=this.block.querySelectorAll(".et-inner a"),i=document.querySelectorAll(".et-annot");let o=1;i.forEach((i,s)=>{i.querySelector(".et-annot-body");const l=i.querySelector(".et-annot-index"),r=i.querySelector(".et-annot-toggle"),c=i.querySelector(".et-annot-close"),a=(i=e.appendChild(i)).dataset.highlight;n.forEach((function(e,n){if(a===e.innerText){const n=i.dataset.type;e.classList.add("et-highlight"),e.dataset.type=n,e.dataset.index=o,i.dataset.index=o,l.innerText=o,t.annots[o]=i,t.highlights[o]=e}})),i.onmouseover=function(e){let n=i.dataset.index;t.showConnection(n)},i.onmouseleave=function(e){let n=i.dataset.index;t.hideConnection(n)},r.onclick=function(e){t.resizeAnnotation(i)},c.onclick=function(e){t.unselectAnnotation(i)},i.classList.remove("hidden"),o++}),n.forEach((function(e,n){const i=e.dataset.type,o=e.dataset.index,s=t.annots[o];s&&s.classList.add(i);let l=e.innerText,r=parseInt(e.dataset.index),c=l.split(" "),a=c.length;isNaN(r)?e.setAttribute("class","inactive"):(c.length>1?(c[0]="<span class='et-first'>"+c[0]+"</span>",c[a-1]="<span class='et-last' data-index-label='"+r+"'>"+c[a-1]+"</span>"):c[0]="<span class='et-first et-last' data-index-label='"+r+"'>"+c[0]+"</span>",e.innerHTML=c.join(" ")),e.onclick=function(n){n.preventDefault();let i=e.dataset.index;t.selectAnnotation(i)},e.onmouseover=function(n){let i=e.dataset.index;t.showConnection(i)},e.onmouseleave=function(n){let i=e.dataset.index;t.hideConnection(i)}})),this.side.onscroll=function(t){},window.onscroll=function(e){t.positionAnnotations()},window.onresize=function(e){t.positionAnnotations()},this.positionAnnotations()}}window.onload=function(){new i}},function(t,e,n){}])}));